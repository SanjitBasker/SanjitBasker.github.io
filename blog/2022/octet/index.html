<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>OCTET | Sanjit Basker</title>
    <meta name="author" content="Sanjit  Basker">
    <meta name="description" content="creating a text editor in OCaml">
    <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website">


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous">

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous">
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700%7CRoboto+Slab:100,300,400,500,700%7CMaterial+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light">

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%91%8B&lt;/text&gt;&lt;/svg&gt;">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://sanjitbasker.github.io/blog/2022/octet/">
    
    <!-- Dark Mode -->
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark">

    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/dark_mode.js"></script>
    

  </head>

  <!-- Body -->
  <body class="fixed-top-nav ">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="/">Sanjit Basker</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">about</a>
              </li>
              
              <!-- Blog -->
              <li class="nav-item active">
                <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a>
              </li>

              <!-- Other pages -->
              <!--
              <li class="nav-item dropdown ">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">table of contents</a>
                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="/publications/">publications</a>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item" href="/projects/">projects</a>
                </div>
              </li> -->

              <!-- Toogle theme mode -->
              <!-- <li class="toggle-container">
                <button id="light-toggle" title="Change theme">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </button>
              </li> -->
            </ul>
          </div>
        </div>
      </nav>

      <!-- Scrolling Progress Bar -->
      <progress id="progress" value="0">
        <div class="progress-container">
          <span class="progress-bar"></span>
        </div>
      </progress>
    </header>


    <!-- Content -->
    <div class="container mt-5">
      <!-- _layouts/post.html -->
<!-- Page/Post style -->
<style type="text/css">
  img.center {
  display: block;
  margin: 0 auto;
  border: 1px solid #FFFFFF
} div.caption {
 margin-left: auto;
 margin-right: auto;
 width: 500px;
}

</style>


<div class="post">

  <header class="post-header">
    <h1 class="post-title">OCTET</h1>
    <p class="post-meta">January 1, 2022</p>
    <p class="post-tags">
      <a href="/blog/2022"> <i class="fas fa-calendar fa-sm"></i> 2022 </a>

    </p>
  </header>

  <article class="post-content">
    <h2 id="highlights">Highlights</h2>
<ul>
  <li>I learned a functional programming language, OCaml üê™</li>
  <li>I worked in a group of 3 to create Octet, an Emacs-like text editor ‚öõÔ∏è</li>
  <li>I designed the interface for and implemented a text buffer üìÅ</li>
</ul>

<p><br>
<br></p>

<h2 id="basics-of-ocaml">Basics of OCaml</h2>

<p>Unlike most programming languages, OCaml is functional: this means that rather than changing the state of variables (or even ‚Äúobjects‚Äù) throughout a program, each name (like a variable <code class="language-plaintext highlighter-rouge">x</code>) is only assigned to once. The main abstraction provided by functional languages is that of first-class functions: ‚Äúfirst-class‚Äù here means that these functions can be stored into variables just like integers and booleans.</p>

<p>Here‚Äôs a simple program written in OCaml that implements insertion sort.</p>
<div class="language-ocaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">(* taken from CS 3110, spring 2022 *)</span>
<span class="k">let</span> <span class="k">rec</span> <span class="n">isort</span> <span class="o">=</span>
  <span class="c">(* insert [x] into its correct position in [lst] and return the result *)</span>
  <span class="k">let</span> <span class="k">rec</span> <span class="n">insert</span> <span class="n">x</span> <span class="n">lst</span> <span class="o">=</span>
    <span class="k">match</span> <span class="n">lst</span> <span class="k">with</span>
    <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="p">[</span> <span class="n">x</span> <span class="p">]</span>
    <span class="o">|</span> <span class="n">h</span> <span class="o">::</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">h</span> <span class="k">then</span> <span class="n">x</span> <span class="o">::</span> <span class="n">h</span> <span class="o">::</span> <span class="n">t</span> <span class="k">else</span> <span class="n">h</span> <span class="o">::</span> <span class="n">insert</span> <span class="n">x</span> <span class="n">t</span>
  <span class="k">in</span>
  <span class="c">(* to sort a list, sort all but the first element and then insert the first element 
     where it belongs
     more concisely, "insert head into sorted tail" *)</span>
  <span class="k">function</span>
  <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="bp">[]</span>
  <span class="o">|</span> <span class="n">h</span> <span class="o">::</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">insert</span> <span class="n">h</span> <span class="p">(</span><span class="n">isort</span> <span class="n">t</span><span class="p">)</span>
</code></pre></div></div>

<p>The above program is fairly easy to understand and reason about (once one gains familiarity with the syntax), but the runtime is quite slow for large lists: this is because in the worst case, the inner function <code class="language-plaintext highlighter-rouge">insert</code> takes stack space proportional to the size of its input, and so does <code class="language-plaintext highlighter-rouge">isort</code> itself. In an average-case input, the minimum element will be about halfway down the list. Regardless, the number of call-frame initializations performed in this implementation is \(O(n^2)\), which is an expensive price to pay for ‚Äúreadable‚Äù code.</p>

<p>A compiler could rewrite this function in <a href="https://en.wikipedia.org/wiki/Continuation-passing_style" rel="external nofollow noopener" target="_blank">continuation-passing style</a> (which uses constant stack space), by adding an extra argument <code class="language-plaintext highlighter-rouge">cont</code>, which is a function representing the remainder of the computation:</p>

<div class="language-ocaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">let</span> <span class="n">isort_cp</span> <span class="n">lst</span> <span class="o">=</span>
  <span class="k">let</span> <span class="n">insert_cp</span> <span class="n">lst</span> <span class="n">x</span> <span class="o">=</span>
    <span class="k">let</span> <span class="k">rec</span> <span class="n">aux</span> <span class="n">cont</span> <span class="n">x</span> <span class="n">lst</span> <span class="o">=</span>
      <span class="k">match</span> <span class="n">lst</span> <span class="k">with</span>
      <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="n">cont</span> <span class="p">[</span> <span class="n">x</span> <span class="p">]</span>
      <span class="o">|</span> <span class="n">h</span> <span class="o">::</span> <span class="n">t</span> <span class="o">-&gt;</span>
          <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">h</span> <span class="k">then</span> <span class="n">cont</span> <span class="p">(</span><span class="n">x</span> <span class="o">::</span> <span class="n">lst</span><span class="p">)</span>
          <span class="k">else</span> <span class="n">aux</span> <span class="p">(</span><span class="k">fun</span> <span class="n">l</span> <span class="o">-&gt;</span> <span class="n">cont</span> <span class="p">(</span><span class="n">h</span> <span class="o">::</span> <span class="n">l</span><span class="p">))</span> <span class="n">x</span> <span class="n">t</span>
    <span class="k">in</span>
    <span class="n">aux</span> <span class="p">(</span><span class="k">fun</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">x</span><span class="p">)</span> <span class="n">x</span> <span class="n">lst</span>
  <span class="k">in</span>
  <span class="k">let</span> <span class="k">rec</span> <span class="n">aux</span> <span class="n">cont</span> <span class="n">lst</span> <span class="o">=</span>
    <span class="k">match</span> <span class="n">lst</span> <span class="k">with</span>
    <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="n">cont</span> <span class="bp">[]</span>
    <span class="o">|</span> <span class="n">h</span> <span class="o">::</span> <span class="n">t</span> <span class="o">-&gt;</span> <span class="n">aux</span> <span class="p">(</span><span class="k">fun</span> <span class="n">l</span> <span class="o">-&gt;</span> <span class="n">cont</span> <span class="p">(</span><span class="n">insert_cp</span> <span class="n">l</span> <span class="n">h</span><span class="p">))</span> <span class="n">t</span>
  <span class="k">in</span>
  <span class="n">aux</span> <span class="p">(</span><span class="k">fun</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">x</span><span class="p">)</span> <span class="n">lst</span>
</code></pre></div></div>

<p>As it turns out, storing an entire function is not necessary in this case and we can get by with <code class="language-plaintext highlighter-rouge">pred</code>, which is just the portion of the list we‚Äôve traversed. And instead of ‚Äúinserting head into sorted tail,‚Äù we can just insert the elements from the original list one by one, into an accumulator initialized as the empty list <code class="language-plaintext highlighter-rouge">[]</code>.</p>

<div class="language-ocaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">(* written by me *)</span>
<span class="k">let</span> <span class="n">isort_tr</span> <span class="n">lst</span> <span class="o">=</span>
  <span class="k">let</span> <span class="n">insert_tr</span> <span class="n">lst</span> <span class="n">x</span> <span class="o">=</span>
    <span class="k">let</span> <span class="k">rec</span> <span class="n">aux</span> <span class="n">pred</span> <span class="n">x</span> <span class="o">=</span> <span class="k">function</span>
      <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="nn">List</span><span class="p">.</span><span class="n">rev_append</span> <span class="n">pred</span> <span class="p">[</span> <span class="n">x</span> <span class="p">]</span>
      <span class="o">|</span> <span class="n">h</span> <span class="o">::</span> <span class="n">t</span> <span class="o">-&gt;</span>
          <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">h</span> <span class="k">then</span> <span class="nn">List</span><span class="p">.</span><span class="n">rev_append</span> <span class="p">(</span><span class="n">x</span> <span class="o">::</span> <span class="n">pred</span><span class="p">)</span> <span class="p">(</span><span class="n">h</span> <span class="o">::</span> <span class="n">t</span><span class="p">)</span>
          <span class="k">else</span> <span class="n">aux</span> <span class="p">(</span><span class="n">h</span> <span class="o">::</span> <span class="n">pred</span><span class="p">)</span> <span class="n">x</span> <span class="n">t</span>
    <span class="k">in</span>
    <span class="n">aux</span> <span class="bp">[]</span> <span class="n">x</span> <span class="n">lst</span>
  <span class="k">in</span>
  <span class="nn">List</span><span class="p">.</span><span class="n">fold_left</span> <span class="n">insert_tr</span> <span class="bp">[]</span> <span class="n">lst</span>
</code></pre></div></div>

<p>The library functions <a href="https://v2.ocaml.org/api/List.html#VALfold_left" rel="external nofollow noopener" target="_blank"><code class="language-plaintext highlighter-rouge">List.fold_left</code></a> and <a href="https://v2.ocaml.org/api/List.html#VALrev_append" rel="external nofollow noopener" target="_blank"><code class="language-plaintext highlighter-rouge">List.rev_append</code></a> are themselves tail-recursive, meaning that this entire function uses constant stack space!</p>

<p>The optimization is important if the lists we‚Äôre working with are long. The <a href="https://v2.ocaml.org/api/List.html" rel="external nofollow noopener" target="_blank"><code class="language-plaintext highlighter-rouge">List</code></a> documentation says it makes a difference when the length is around 10000. Indeed, on my machine <code class="language-plaintext highlighter-rouge">isort</code> has a noticeable delay for a reverse-sorted input of size 5000 while <code class="language-plaintext highlighter-rouge">isort_tr</code> is fast even for 20000 elements.</p>

<p><br></p>

<h2 id="project-proposal-and-philosophy">Project Proposal and Philosophy</h2>

<p>As a final project for this class, my group decided to implement a text editor with keybindings similar to Emacs. We decided to interface with <a href="https://github.com/pqwy/notty" rel="external nofollow noopener" target="_blank"><code class="language-plaintext highlighter-rouge">Notty</code></a>, a package for displaying text to the terminal. We also researched options for autoformatting and syntax-highlighting code and decided to use <a href="https://github.com/ocaml/ocaml-lsp" rel="external nofollow noopener" target="_blank"><code class="language-plaintext highlighter-rouge">ocaml-lsp</code></a>.</p>

<p>In this project, we prioritized building end-to-end. We decided (somewhat ambitiously) that our first milestone would be a bare-bones text editor with all our dependencies set up, and that for the second and third sprint we‚Äôd work on the backend and frontend in parallel while maintaining the interface from the prototype. This structure is described in <em>Pragmatic Programmer</em> as a ‚Äútracer bullet.‚Äù</p>

<p><br></p>

<h2 id="project-management-and-accountability">Project Management and Accountability</h2>

<p>Since I was working in a group of 3, it was important for us to keep each other accountable. We reported to each other weekly and had three progress update meetings with our ‚Äúproject manager,‚Äù a CS 3110 TA.</p>

<p><img src="/assets/img/octet-images/scope2.png" alt="drawing" width="500" class="center"></p>

<div class="caption">Here's a screenshot from our second progress report. We delivered on most of what was planned and delayed searching file contents to our third sprint.</div>

<p><br></p>

<h2 id="buffer-implementation">Buffer Implementation</h2>

<p>My task was to implement the buffer which allowed for modifications to the text. The buffer implementation is nontrivial because inserting or removing a character from a string is not an \(O(1)\) operation. However, based on the expected usage (for example, writing a long paragraph the same point in the text editor vs. lightly editing words throughout a file) the performance of an ‚Äúoptimal‚Äù buffer implementation can vary.</p>

<p>Our first buffer was just a list of strings, which had very poor asymptotic performance but was fine for small text files. We used this in our first milestone and made it a priority to rewrite as part of the second sprint.</p>

<p>The key insight we had in improving the buffer is that the user must first <em>move</em> the cursor to the location where the text is being inserted. While our prior implementations simply stored the cursor location as a pair of integers and updated that field. In our later implementations, we actually updated the backend‚Äôs representation of the current line every time the cursor was moved. Technically, this worsened our latency, but it majorly improved our throughput on workloads consisting of lightly editing various parts of a line.</p>

<p>The one aspect of our runtime which we were not able to effectively amortize was memory allocation: when the buffer ran out of space, we had to allocate a larger one and copy over characters. Because our text editor is single-threaded, this latency cannot be masked to the user and the inputs may lag. However, by setting a large resize factor, we ensure that this situation occurs very rarely, and only when the buffer is growing for the first time.</p>

<p>In testing my buffer, I kept around the old implementations and tested extensively with OUnit. I wrote glass-box and random tests and compared the behavior of each implementation to ensure that it matched the implementation backed by a list of strings (which was straightforward enough that we could treat it like a specification).</p>

<p><img src="/assets/img/octet-images/screenshot.png" alt="drawing" width="500" class="center"></p>

<div class="caption">Here's our text editor in action. Syntax highlighting is enabled for OCaml, and some text is highlighted and copied to the clipboard.</div>

<p><br></p>

<h2 id="lessons-learned">Lessons Learned</h2>

<p>While our goal in building an end-to-end prototype in the first sprint was ambitious, I think that it was effective because it forced us to (1) plan out the interfaces we‚Äôd use and (2) gave us space to work on things in parallel in the following sprints.</p>

  </article>
</div>

    </div>

    <!-- Footer -->    
    <footer class="fixed-bottom">
      <div class="container mt-0">
        ¬© Copyright 2023 Sanjit  Basker. Forked from <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a>. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>.

      </div>
    </footer>

    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/masonry.js" type="text/javascript"></script>
    
  <!-- Medium Zoom JS -->
  <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script>
  <script defer src="/assets/js/zoom.js"></script><!-- Load Common JS -->
  <script defer src="/assets/js/common.js"></script>
  <script defer src="/assets/js/copy_code.js" type="text/javascript"></script>

    
  <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script>
  <script async src="https://badge.dimensions.ai/badge.js"></script>

    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    
    

<!-- Scrolling Progress Bar -->
<script type="text/javascript">
  /*
   * This JavaScript code has been adapted from the article 
   * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar, 
   * published on the website https://css-tricks.com on the 7th of May, 2014.
   * Couple of changes were made to the original code to make it compatible 
   * with the `al-foio` theme.
   */
  const progressBar = $("#progress");
  /*
   * We set up the bar after all elements are done loading.
   * In some cases, if the images in the page are larger than the intended
   * size they'll have on the page, they'll be resized via CSS to accomodate
   * the desired size. This mistake, however, breaks the computations as the
   * scroll size is computed as soon as the elements finish loading.
   * To account for this, a minimal delay was introduced before computing the
   * values.
   */
  window.onload = function () {
    setTimeout(progressBarSetup, 50);
  };
  /*
   * We set up the bar according to the browser.
   * If the browser supports the progress element we use that.
   * Otherwise, we resize the bar thru CSS styling
   */
  function progressBarSetup() {
    if ("max" in document.createElement("progress")) {
      initializeProgressElement();
      $(document).on("scroll", function() {
        progressBar.attr({ value: getCurrentScrollPosition() });
      });
      $(window).on("resize", initializeProgressElement);
    } else {
      resizeProgressBar();
      $(document).on("scroll", resizeProgressBar);
      $(window).on("resize", resizeProgressBar);
    }
  }
  /*
   * The vertical scroll position is the same as the number of pixels that
   * are hidden from view above the scrollable area. Thus, a value > 0 is
   * how much the user has scrolled from the top
   */
  function getCurrentScrollPosition() {
    return $(window).scrollTop();
  }

  function initializeProgressElement() {
    let navbarHeight = $("#navbar").outerHeight(true);
    $("body").css({ "padding-top": navbarHeight });
    $("progress-container").css({ "padding-top": navbarHeight });
    progressBar.css({ top: navbarHeight });
    progressBar.attr({
      max: getDistanceToScroll(),
      value: getCurrentScrollPosition(),
    });
  }
  /*
   * The offset between the html document height and the browser viewport
   * height will be greater than zero if vertical scroll is possible.
   * This is the distance the user can scroll
   */
  function getDistanceToScroll() {
    return $(document).height() - $(window).height();
  }

  function resizeProgressBar() {
    progressBar.css({ width: getWidthPercentage() + "%" });
  }
  // The scroll ratio equals the percentage to resize the bar
  function getWidthPercentage() {
    return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
  }
</script>

  </body>
</html>
